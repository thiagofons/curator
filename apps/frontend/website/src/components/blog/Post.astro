---
import { getLangFromUrl, useTranslations } from "@/i18n/utils";
import {
  BodySmall,
  ButtonText,
  H3,
  SubheadingXS,
} from "@repo/ui-web/components/custom/typography.jsx";

type Props = {
  post: any;
};

const { post } = Astro.props;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<a
  href={`/blog/posts/${post.id}`}
  class="border-primary hover:border-primary/60 group grid h-full grid-cols-1 grid-rows-[auto_1fr] overflow-hidden rounded-2xl border-2 transition-colors duration-200"
>
  <div class="overflow-hidden">
    {
      post.data.image ? (
        <img
          src={post.data.image}
          alt={post.data.title}
          width={445}
          height={230}
          class="aspect-445/230 w-full object-cover"
        />
      ) : (
        <div class="bg-muted aspect-445/230 w-full" />
      )
    }
  </div>

  <div class="flex flex-col gap-4 p-4">
    <div class="flex flex-col gap-2.5">
      <div class="flex flex-col gap-1">
        <div class="flex w-full items-start justify-between gap-2">
          <div class="flex flex-col gap-1">
            <div class="flex items-center gap-2">
              <div
                class="bg-primary flex items-center justify-center rounded-full px-3 py-0.5"
              >
                <ButtonText color="white">{t("blog.post.badge")}</ButtonText>
              </div>
            </div>
            <H3 color="foreground" className="line-clamp-2 group-hover:text-primary transition-colors">
              {post.data.title}
            </H3>
          </div>
        </div>

        <SubheadingXS color="muted-foreground">
          {
            post.data.authors.map((name: string) => (
              <span>
                {t("blog.post.author_prefix")} {name}
              </span>
            ))
          }
        </SubheadingXS>
      </div>

      {
        post.data.categories && post.data.categories.length > 0 && (
          <div class="flex flex-wrap gap-2">
            {post.data.categories.map((category: string, i: number) => (
              <span
                class="text-foreground border-primary flex items-center justify-center rounded-full border px-3 py-0.5"
                onclick={(e: MouseEvent) => e.preventDefault()}
              >
                <BodySmall>{category}</BodySmall>
              </span>
            ))}
          </div>
        )
      }
    </div>

    {
      post.body && (
        <BodySmall color="muted-foreground" className="line-clamp-3">
          {post.body}
        </BodySmall>
      )
    }
  </div>
</a>
