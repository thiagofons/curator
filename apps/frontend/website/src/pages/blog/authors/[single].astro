---
import Base from "@/layouts/Base.astro"
import { getPayloadAuthors, getPayloadPostsByAuthorSlug } from "@/lib/payload"
import AuthorSingle from "@/partials/AuthorSingle.astro"

export async function getStaticPaths() {
  const authors = await getPayloadAuthors()

  const paths = authors.map((author) => ({
    params: {
      single: author.slug,
    },
    props: {
      author,
      isPayload: true,
      contentHtml: author.contentHtml,
    },
  }))
  return paths
}

const { author, isPayload, contentHtml } = Astro.props as {
  author: any
  isPayload?: boolean
  contentHtml?: string
}
const { title, image } = author.data
const posts = await getPayloadPostsByAuthorSlug(author.slug)
---

<Base title={title}>
  <AuthorSingle author={author} posts={posts} isPayload={isPayload} contentHtml={contentHtml} />
</Base>
